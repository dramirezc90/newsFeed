<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/neon-animation/neon-animation-behavior.html">
<link rel="import" href="../../bower_components/neon-animation/neon-animation-runner-behavior.html">





<dom-module id="news-element">
    <style>
        :host {
            display: block;
            width: 100%;
            float: left;
            height: 800px;
        }
        #banner {
          width: 600px;
          min-height: 500px;
          max-height: 800px;
          background-color: #D4CDCB;
          display: block;
          margin: 0 auto;
          border-radius: 10px 10px 0px 0px;
        }
        #header {
          width: 100%;
          height: 60px;
          background-color: #FF6855;
          border-radius: 10px 10px 0px 0px;
          padding: 17px 37px;
        }
        #menu {
          width: 45px;
        }
        #content {
          width: 100%;
          min-height: 440px;
          max-height: 740px;
          padding: 10px 37px;
          overflow: scroll;
        }
        #btn {
          padding: 10px;
          display: block;
          color: white;
          background-color: black;
        }
        @media only screen and (max-width: 600px) {
            :host {
                /*position: relative;
                float: left;
                width: 100%;*/
            }
        }
    </style>
    <template>
        <iron-ajax 
          id="ajaxReq" 
          url="../../scripts/news_mock.json" 
          handle-as="json" 
          last-response="{{ newsData }}" 
          on-response="handleResponse">
        </iron-ajax>

        <button id="btn" on-tap="show">Animar</button>
        <div id="banner">
          <div id="header">
            <a on-tap="menuPressed"><img id="menu" src="../../images/technology.png"></a>
          </div>
          <div id="content" >
            <template id="entradas" is="dom-repeat" items="{{ newsData }}" >
                <news-item titulo="{{item.title}}" texto="{{item.content}}" imagen="{{item.image}}" style="
                display: none" ></news-item>
            </template>
          </div>
        </div>
    </template>

  <script>
    (function() {
      'use strict';

      Polymer({
          is: 'news-element',

          behaviors: [
            Polymer.NeonAnimatableBehavior,
            Polymer.NeonAnimationRunnerBehavior
          ],

          properties: {
              oculto : {
                type: Boolean,
                value: true,
                notify: true
              },
              animationConfig: {
                  type: Object,
                  value: function() {
                      return {
                          'entry' : [
                              {
                                  name: 'bounce-up-animation',
                                  node: this.$.banner,
                                  timing: { duration: 1000 }
                              },
                              {
                                  name: 'fade-in-animation',
                                  node: this.$.banner,
                                  timing: { duration: 1000 }
                              }
                          ],
                          'exit' : {
                              name: 'fade-out-animation',
                              node: this.$.banner
                          },
                          'elems': [{
                              name: 'cascaded-animation',
                              animation: 'expand-left-animation',
                              axis: 'x',
                              timing: {
                                delay: 100,
                                duration: 1000
                              }
                          }]
                      }
                  }
              }
          },

          listeners: {
              'neon-animation-finish': "_onNeonAnimationFinish"
          },

          ready: function() {
              this.show();
          },

          handleResponse: function(e) {
              this.attached();
          },

          menuPressed: function() {
            this.$.ajaxReq.generateRequest();
          },

          _onNeonAnimationFinish: function() {
              console.log("Se termino la animacion");
          },

          show: function() {
              this.style.display = 'block';
              this.cancelAnimation();
              this.playAnimation('entry');
          },

          hide: function() {
              this.style.display = 'none';
              this.cancelAnimation();
              this.playAnimation('exit');
          },

          attached: function() {
              this.async(function() {
                var nodeList = Polymer.dom(this.root).querySelectorAll('news-item');
                this.animationConfig['elems'][0].nodes = Array.prototype.slice.call(nodeList);
                for (var i = nodeList.length - 1; i >= 0; i--) {
                  nodeList[i].style.display = "block";
                }
                this.playAnimation('elems');
              })
          }

      });
    })();
  </script>
</dom-module>
